"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[727],{70369:(e,t,n)=>{n.d(t,{$:()=>a.$});var a=n(22578)},8416:(e,t,n)=>{n.r(t),n.d(t,{QueueHistoryRoutes:()=>xe,default:()=>De});var a=n(67294),r=n.n(a),l=n(47886),i=n(9832),c=n(69518),s=n.n(c),o=n(28248),u=n(42922),m=n(80806),d=n(59713),p=n.n(d),g=n(98269),E=n(80624);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const b=[];function f(e,t=!0){const[n,r]=(0,a.useState)({});return(0,a.useEffect)((()=>{if(!t)return;const a=Array.from(new Set(e)),l=a.filter((e=>s().isTrack(e)&&!n[e])),i=a.filter((e=>s().isEpisode(e)&&!n[e])),c=l.length?g.fQ.getTracks(E.b.getInstance(),l.map((e=>s().from(e).getBase62Id()))).then((e=>e.body.tracks||b)):Promise.resolve(b),o=i.map((e=>g.UY.getEpisodeGraphQL(E.b.getInstance(),s().from(e).getBase62Id()).then((e=>(null==e?void 0:e.body)||{})).catch((t=>(console.error(t),{uri:e})))));Promise.all([c,...o]).then((([e,...t])=>{const n={},a={};e.forEach((e=>{var t;n[(null==e||null===(t=e.linked_from)||void 0===t?void 0:t.uri)||e.uri]=e})),t.forEach((e=>{a[e.uri]=e})),(e.length>0||t.length>0)&&r((e=>v(v(v({},e),n),a)))}))}),[e,n,t]),e.map((e=>n[e]))}var h=n(49961),O=n(47991),w=n(42781);const k=r().memo((({items:e})=>{const t=f(e.map((e=>e.uri))),n=(0,a.useMemo)((()=>t.map(((t,n)=>e[n].isLocal?e[n]:t))),[t,e]),l=(0,a.useCallback)(((e,t)=>{if((a=e).type===w.p.TRACK&&s().isTrack(a.uri)){var n;const a=(0,h.X)(null===(n=e.album)||void 0===n?void 0:n.images,{desiredSize:40});return r().createElement(m.Lk,{key:t+e.uri,index:t,uri:(0,O.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==a?void 0:a.url)||"",album:e.album,artists:e.artists,isExplicit:e.explicit,isMOGEFRestricted:(e.tags||[]).includes("MOGEF-19+")})}var a,l,i;if((e=>e.type===w.p.EPISODE)(e)){var c;const n=(0,h.X)(null===(c=e.show)||void 0===c?void 0:c.images,{desiredSize:40});return r().createElement(m.Lk,{key:t+e.uri,index:t,uri:(0,O.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==n?void 0:n.url)||"",album:{name:e.show.name,uri:e.show.uri},artists:[{name:e.show.publisher,uri:""}],isExplicit:e.explicit,isMOGEFRestricted:!1})}return(e=>e.type===w.p.TRACK&&s().isLocalTrack(e.uri))(e)?r().createElement(m.Lk,{key:t+e.uri,index:t,uri:e.uri,name:e.name,duration_ms:e.duration,imgUrl:e.imageUrl||"",album:{name:(null===(l=e.album)||void 0===l?void 0:l.name)||"",uri:""},artists:[{name:(null===(i=e.artist)||void 0===i?void 0:i.name)||"",uri:""}],isExplicit:e.isExplicit,isMOGEFRestricted:!1}):r().createElement(o.hU,{height:`${o.dN}px`})}),[]),i=(0,a.useMemo)((()=>[o.QD.TITLE,o.QD.ALBUM_OR_PODCAST,o.QD.DURATION]),[]),c=(0,a.useCallback)((e=>e.uri),[]);return r().createElement(r().Fragment,null,r().createElement(u.ZP,{value:"play-history-tracklist"},r().createElement(o.Pv,{ariaLabel:"play-history",hasHeaderRow:!0,columns:i,renderRow:l,resolveUri:c,tracks:n,nrTracks:n.length,rowPlaceholder:o.hU,limit:50})))}));var N=n(73012),C=n(76343),x=n(31),D=n(20657);const P="YezyfIlG57oiowFBBZRo",I="_Tn1zrc7dtlexw_8ydLS",q="s6H04SVnFrlc8SMgFfiO",U=()=>r().createElement("div",{className:P},r().createElement(x.l,{iconSize:64}),r().createElement(C.Dy.h1,{variant:C.$e.alto,color:N.$_Y.white,className:I},D.ag.get("history.empty-title")),r().createElement("p",null,D.ag.get("history.empty-description"))),_="NhOZAMNMyVobUw4v2EbT",S="FpIeNH0Pg1EyMyPtE5y4",$=()=>{const e=(0,i.U5)();return e&&e.items.length>0?r().createElement("div",{className:_},r().createElement(C.Dy.h1,{variant:C.$e.canon,color:N.$_Y.white,className:S},D.ag.get("view.recently-played")),r().createElement(k,{items:e.items})):r().createElement(U,null)};var j=n(94184),F=n.n(j),L=n(67892),A=n(56802),T=n(23716),R=n(99995);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const M=(e,t)=>{const n=f(e.slice(0,50).map((e=>e.uri)),t);return t?e.reduce(((e,t,a)=>(n[a]&&e.push(((e,t)=>(0,R.G_)(e)&&(e=>"track"===e.type)(t)?B(B({},e),{},{name:t.name,album:B(B({},e.album),{},{name:t.album.name,images:t.album.images,uri:t.album.uri}),artists:t.artists.map((e=>({name:e.name,uri:e.uri,type:w.p.ARTIST}))),duration:{milliseconds:t.duration_ms},isExplicit:t.explicit,is19PlusOnly:(t.tags||[]).includes("MOGEF-19+")}):(0,R.iw)(e)&&(e=>"episode"===e.type)(t)?B(B({},e),{},{name:t.name,show:B(B({},e.show),{},{name:t.show.name,images:t.show.images,uri:t.show.uri}),duration:{milliseconds:t.duration_ms}}):e)(t,n[a])),e)),[]):e},Y=r().memo((({tracks:e,ariaLabel:t,contextUri:n,rowNumberOffset:l=0,section:i,usePlayContextItem:c})=>{const s=(0,A.o)(),u=(0,T.g)(),m=M(e,!u.getCapabilities().hasDecoratedQueue),d=(0,a.useCallback)(((e,t)=>{s({intent:"remove-from-queue",type:"click"}),u.removeFromQueue(e.map((e=>({uid:e.id,uri:e.uri})))).then(t)}),[u,s]),p=(0,a.useCallback)(((e,t)=>{if((0,R.iw)(e)){var a,s;const u=(0,h.X)(null===(a=e.show)||void 0===a?void 0:a.images,{desiredSize:40});return r().createElement(o.pD,{key:`${t}${l}${e.uid}`,index:t,rowNumberOffset:l,imgUrl:(null==u?void 0:u.url)||"",uri:(0,O.$V)(e),uid:null!==(s=e.uid)&&void 0!==s?s:e.uri,contextUri:n,duration_ms:e.duration.milliseconds,name:e.name,artists:[],album:{name:e.show.name,uri:e.show.uri},isExplicit:!1,isPlayable:!0,isMOGEFRestricted:!1,type:o.jO.EPISODE,section:i,usePlayContextItem:c})}if((0,R.G_)(e)){var u,m,d,p;const a=(0,h.X)(null==e||null===(u=e.album)||void 0===u?void 0:u.images,{desiredSize:40});return r().createElement(o.pD,{key:`${t}${l}${e.uid}`,index:t,rowNumberOffset:l,imgUrl:(null==a?void 0:a.url)||"",uri:(0,O.$V)(e),uid:null!==(m=e.uid)&&void 0!==m?m:e.uri,contextUri:n,duration_ms:e.duration.milliseconds,name:e.name,artists:e.artists,album:e.album,isExplicit:null!==(d=e.isExplicit)&&void 0!==d&&d,isPlayable:!0,isMOGEFRestricted:null!==(p=e.is19PlusOnly)&&void 0!==p&&p,type:e.isLocal?o.jO.LOCAL:o.jO.TRACK,section:i,usePlayContextItem:c})}return r().createElement(o.Lb,{height:`${o.dN}px`})}),[l,n,i,c]),g=(0,a.useMemo)((()=>[o.QD.INDEX,o.QD.TITLE,o.QD.ALBUM,o.QD.DURATION]),[]),E=(0,a.useCallback)((e=>e.uri),[]),y=(0,a.useCallback)((e=>{var t;return null!==(t=e.uid)&&void 0!==t?t:e.uri}),[]);return m&&r().createElement(o.Pv,{ariaLabel:t,tracks:m,nrTracks:m.length,onRemove:d,renderRow:p,resolveUri:E,resolveUid:y,columns:g})})),z="B4US7DUjOgK0D_y4J51V";var G=n(62890);const V=({onClick:e})=>r().createElement(G.z,{className:z,version:"outlined",onClick:e,title:D.ag.get("queue.clear-queue")},r().createElement(C.Dy,{variant:C.$e.minuetBold},D.ag.get("queue.clear-queue"))),Z="_l3NQhoOwzJ4c1VLuIrV",X="Qf7Bwx7CCoLVdRuv0n1k",H="b9CuE_dPIQ3uCPhmaFpR",W="AyIwCK6ScJYNYw1FoBZJ",J="T4JEcDRVmypkMAiYZEfB",K="bgfoGfOr7BmpLUq73Dlr",ee="AkezbjhtFNdNa4W3cPzA",te="CHCDHImhag8Pu09vGTaX",ne="SXsJ1Ff7N6yJkrLXfxSe",ae="_XGCig_AUNTndgq6IBco";var re=n(85105),le=n(16229),ie=n(18061),ce=n(44503),se=n(21770),oe=n(99450);const ue=r().memo((({onClose:e,onConfirm:t,isOpen:n,itemCount:l})=>{const i=(0,a.useCallback)((n=>{t(),e(n)}),[t,e]),c=D.ag.get("queue.confirm-title",l);return r().createElement(re.Z,{shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:c,isOpen:n},r().createElement("div",{className:K},r().createElement(C.Dy,{as:"h2",variant:C.Dy.cello,className:ee},c),r().createElement(C.Dy,{as:"p",variant:C.Dy.mesto,className:te},D.ag.get("queue.confirm-message")),r().createElement("div",{className:ne},r().createElement(ie.F,{property:ce.iY,renderOldExperience:()=>r().createElement(le.Y,{className:ae,version:"tertiary",onClick:e},D.ag.get("queue.cancel-button")),renderNewExperience:()=>r().createElement(se.oM,{onClick:e},D.ag.get("queue.cancel-button"))}),r().createElement(ie.F,{property:ce.iY,renderOldExperience:()=>r().createElement(le.Y,{version:"primary",onClick:i},D.ag.get("queue.confirm-button")),renderNewExperience:()=>r().createElement(oe.D,{onClick:i},D.ag.get("queue.confirm-button"))}))))}));var me=n(84242),de=n(14472),pe=n(76),ge=n(83993);const Ee=()=>r().createElement("div",{className:P},r().createElement(ge.j,{iconSize:64}),r().createElement(C.Dy.h1,{variant:C.$e.alto,color:N.$_Y.white,className:I},D.ag.get("queue.empty-title")),r().createElement("p",null,D.ag.get("queue.empty-description")),r().createElement(pe.OL,{to:"/search",className:q},r().createElement(le.Y,{version:"secondary"},D.ag.get("queue.fine-something"))));var ye=n(34891),ve=n(86081);var be=n(70369),fe=n(11956);const he=()=>{const{uri:e,description:t}=(0,de.$)(),n=(0,T.g)(),{current:l,nextUp:i,queued:c}=function(){const e=(0,T.g)(),[t,n]=(0,a.useState)(e.getQueue());return(0,ve.G)(ye.rg.QUEUE_UPDATE,(e=>n(e.data))),t}(),[s,o]=(0,a.useState)(!1),m=(0,a.useCallback)((()=>{o(!1)}),[o]),d=(0,a.useCallback)((()=>{n.clearQueue(),o(!1)}),[n]),p=(0,a.useCallback)((()=>{o(!0)}),[o]),{usePlayContextItem:g}=(0,me.n)({uri:null!=e?e:""},{featureIdentifier:"queue"}),E=!(null==c||!c.length),y=!(null==i||!i.length);return!1===(l||E||y)?r().createElement(Ee,null):r().createElement("section",{className:Z},r().createElement(be.$,null,D.ag.get("queue.page-title")),r().createElement(C.Dy.h1,{variant:C.$e.canon,color:N.$_Y.white,className:X},D.ag.get("playback-control.queue")),l&&e&&r().createElement(r().Fragment,null,r().createElement(C.Dy.h2,{variant:C.$e.balladBold,color:N.$_Y.gray70},D.ag.get("queue.now-playing")),r().createElement(u.ZP,{value:"now-playing"},r().createElement(Y,{ariaLabel:D.ag.get("queue.now-playing"),tracks:[l],contextUri:e,section:fe.h.NowPlaying,usePlayContextItem:g}))),E&&e&&r().createElement(r().Fragment,null,r().createElement("div",{className:F()(J,H)},r().createElement(C.Dy.h2,{variant:C.$e.balladBold,color:N.$_Y.gray70},D.ag.get("queue.next-in-queue")),E&&r().createElement(V,{onClick:p})),r().createElement(u.ZP,{value:"next-in-queue"},r().createElement(Y,{ariaLabel:D.ag.get("queue.next-in-queue"),tracks:c,rowNumberOffset:1,contextUri:"spotify:app:queue:NextInQueue",section:fe.h.NextInQueue,usePlayContextItem:g}))),y&&e&&r().createElement(r().Fragment,null,r().createElement(C.Dy.h2,{variant:C.$e.balladBold,color:N.$_Y.gray70,className:F()(H,"standalone-ellipsis-one-line")},t?D.ag.get("queue.next-from"):D.ag.get("queue.next-up")," ",r().createElement(L.r,{className:W,to:e},t)),r().createElement(u.ZP,{value:"next-up"},r().createElement(Y,{ariaLabel:D.ag.get("queue.next-up"),tracks:i,rowNumberOffset:1+((null==c?void 0:c.length)||0),contextUri:"spotify:app:queue:NextUp",section:fe.h.NextUp,usePlayContextItem:g}))),r().createElement(ue,{itemCount:(null==c?void 0:c.length)||0,isOpen:s,onClose:m,onConfirm:d}))};var Oe=n(69559),we=n(9746),ke=n(28638);const Ne="HZX6ozVldlime7kQvNZv",Ce=()=>{const[e,t]=(0,a.useState)(window.innerWidth);(0,Oe.a)((()=>{t(window.innerWidth)}));const n=(0,a.useMemo)((()=>[{title:D.ag.get("playback-control.queue"),itemId:"queue",to:"/queue"},{title:D.ag.get("view.recently-played"),itemId:"history",to:"/history"}]),[]);return r().createElement(ke.w,null,r().createElement(we.n,{className:Ne,links:n,windowSize:e}))},xe=()=>{const e=(0,i.nF)();return r().createElement("section",{className:"contentSpacing"},e&&r().createElement(l.AW,{path:"/history"},r().createElement($,null)),r().createElement(l.AW,{path:"/queue"},r().createElement(a.Suspense,{fallback:null},r().createElement(he,null))),e&&r().createElement(Ce,null))},De=xe},9746:(e,t,n)=>{n.d(t,{n:()=>x});var a=n(67294),r=n.n(a),l=n(94184),i=n.n(l),c=n(43031),s=n(20657);const o="mQQafuUEkVAF6_IZIBvx",u="FFWho1ZPRDDGyq9nc4o6",m="HQLDjbV6xRYCfJh7xaFQ",d="m46NG2aV0C_Hh_hOFF_H",p="o7zB3eJkQwbTbMYmUUYk",g="qzbUrDo4r4uBEsHuGDvW",E="RANP_Xq9O1O2VevAb3a8",y="cRcbfCF3jsPg0TEpeWb9",v="_ef8TD60opVEITog7_gB",b="iMpd7siW4KnGNoNu6XS1";var f=n(76343),h=n(32626),O=n(30005),w=n(21691);const k=({items:e,activeItemId:t,setActiveDropdownItem:n})=>r().createElement(O.v,null,e.map((e=>r().createElement(w.s,{role:"menuitemradio",to:e.to,exact:!0,"aria-checked":e.itemId===t,className:g,activeClassName:E,isActive:t=>!!t&&(n(e),!0),onClick:()=>{n(e)}},e.title))));var N=n(26115),C=n(74594);const x=r().memo((({isCentered:e,links:t,landmarkLabel:n,className:l,windowSize:g=1/0})=>{const[O,w]=(0,a.useState)(null),x=(0,a.useRef)(null),[D,P]=(0,a.useState)([]),[I,q]=(0,a.useState)(0),[U,_]=(0,a.useState)([]);(0,a.useEffect)((()=>{x.current&&q(x.current.clientWidth)}),[g]),(0,a.useEffect)((()=>{if(!x.current)return;const e=Array.from(x.current.children).map((e=>e.clientWidth));P(e)}),[t]),(0,a.useEffect)((()=>{if(!x.current)return;if(D.slice(0,-1).reduce(((e,t)=>e+t),0)<=I)return void _([]);const e=D.reduce(((e,t)=>e>t?e:t),0),t=[];let n=e;D.forEach(((e,a)=>{I>=n+e?n+=e:t.push(a)})),_(t)}),[I,D]);const S=(0,a.useCallback)((e=>!!e&&(w(null),!0)),[]);return r().createElement("nav",{className:i()(l,o),"aria-label":n},r().createElement("ul",{className:e?u:v,ref:x},t.filter(((e,t)=>!U.includes(t))).map((e=>r().createElement("li",{key:e.to,className:m},r().createElement(c.O,{exact:!0,className:y,activeClassName:E,to:e.to,isActive:S},r().createElement(f.Dy,{variant:f.Dy.mestoBold},e.title))))),U.length||0===D.length?r().createElement("li",{className:m},r().createElement(h.xV,{renderInline:!0,menu:r().createElement(k,{items:t.filter(((e,t)=>U.includes(t))),activeItemId:null==O?void 0:O.itemId,setActiveDropdownItem:w})},((e,t,n)=>r().createElement("button",{className:i()(d,{[p]:O}),type:"button",onClick:t,ref:n},r().createElement(f.Dy,{as:"span",variant:f.Dy.mestoBold},O?O.title:s.ag.get("more")),e?r().createElement(N.q,{iconSize:16,className:b}):r().createElement(C.m,{iconSize:16,className:b}))))):null))}))}}]);
//# sourceMappingURL=xpui-routes-queue.js.map